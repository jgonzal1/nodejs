<!DOCTYPE html>
<html>
<head>
    <title>Onboarding Color-Picker Demo</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <style type="text/css">@font-face{font-family:'Proxima Nova';src:url(https://cdn.jsdelivr.net/npm/font-proxima-nova@1.0.1/fonts/ProximaNova-Regular.eot);src:local('Proxima Nova Regular'),local('ProximaNova-Regular'),url(https://cdn.jsdelivr.net/npm/font-proxima-nova@1.0.1/fonts/ProximaNova-Regular.eot?#iefix) format('embedded-opentype'),url(https://cdn.jsdelivr.net/npm/font-proxima-nova@1.0.1/fonts/ProximaNova-Regular.woff) format('woff'),url(https://cdn.jsdelivr.net/npm/font-proxima-nova@1.0.1/fonts/ProximaNova-Regular.ttf) format('truetype');font-weight:400;font-style:normal}@font-face{font-family:'Proxima Nova';src:url(https://cdn.jsdelivr.net/npm/font-proxima-nova@1.0.1/fonts/ProximaNova-Bold.eot);src:local('Proxima Nova Bold'),local('ProximaNova-Bold'),url(https://cdn.jsdelivr.net/npm/font-proxima-nova@1.0.1/fonts/ProximaNova-Bold.eot?#iefix) format('embedded-opentype'),url(https://cdn.jsdelivr.net/npm/font-proxima-nova@1.0.1/fonts/ProximaNova-Bold.woff) format('woff'),url(https://cdn.jsdelivr.net/npm/font-proxima-nova@1.0.1/fonts/ProximaNova-Bold.ttf) format('truetype');font-weight:700;font-style:normal}.demo-container *{box-sizing:border-box;font-family:'Proxima Nova',sans-serf}.demo-container{margin:auto;max-width:600px;min-width:400px}.demo-container .body{display:block;height:400px}.demo-container .body:after{content:"";display:table;clear:both}.demo-container h3{font-size:22px;margin:10px auto;text-align:center}.demo-container .left,.demo-container .right{float:left;width:50%;height:350px;margin:12px auto}.demo-container .right{position:relative}@media screen and (max-width:600px){.demo-container .left,.demo-container .right{width:100%}.demo-container .body{height:750px}}@media screen and (min-width:601px){.demo-container #color-display{position:absolute;top:50%;transform:translateY(-50%)}}.demo-container .widget{margin:auto;position: relative;top: 50%;transform: translateY(-50%);}.demo-container #color-display{margin:auto;}.demo-container #color-picker{margin:auto;width:250px}.demo-container .color-picker-container{display:block;margin:auto;text-align:center}.demo-container .pubnub-img{height:50px}.demo-container .inner-color-display{position:absolute;top:50%;left:50%;transform:translateY(-50%) translateX(-50%);width:275px;text-align:center;font-weight:700;color:#333333}.demo-container .inner-color-display p{margin:10px auto;line-height:1.2em}.demo-container p.subscriber-message-top{font-size:20px;margin:-60px auto 60px}.demo-container .subscriber-message-bottom{font-size:17px}.demo-container .subscriber-message-code{font-size:36px}.lightbulb-container{width:150px;margin: auto;}</style>
</head>
<body>
    <div class="demo-container">
        <h3>Select a color to Publish to a Channel </h3>
        <div class="body">
            <div class="left">
                <div class="widget">
                    <div class="color-picker-container">
                        <div class="wheel" id="color-picker"></div>
                    </div>
                </div>
            </div>
            <div class="right">
                <div class="inner-color-display">
                    <div class="lightbulb-container">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 335.81 512"><defs><style>.b{fill:#b79529;}.c{fill:#e8edee;}.d{fill:#cbd4d8;}</style></defs><title>Asset 5</title><path id="lightbulb-fill" d="M334.75,152.72C325.92,73.27,262.36,9.71,182.91.88c-5.3,0-9.71-.88-15-.88a85.83,85.83,0,0,0-15,.88C73.45,9.71,9.89,74.15,1.06,152.72a170.09,170.09,0,0,0,52.09,143C74.33,316,92,342.51,97.28,370.76H238.53c5.29-28.25,23-54.73,44.13-75a170.09,170.09,0,0,0,52.09-143"/><path class="b" d="M114.94,176.55a17.66,17.66,0,1,0,0,35.31h17.65V194.21a17.71,17.71,0,0,0-17.65-17.66Zm88.27,35.31h17.66a17.66,17.66,0,1,0-17.66-17.65Zm-8.82,167.73c-5.3,0-8.83-3.54-8.83-8.83V229.52H150.25V370.76c0,5.29-3.53,8.83-8.83,8.83s-8.83-3.54-8.83-8.83V229.52H114.94a35.31,35.31,0,1,1,35.31-35.31v17.65h35.31V194.21a35.31,35.31,0,1,1,35.31,35.31H203.21V370.76c0,5.29-3.53,8.83-8.82,8.83Z"/><path class="c" d="M97.28,370.76V476.69H238.52V370.76Z"/><path class="d" d="M181.15,512H154.66a26.31,26.31,0,0,1-21.18-10.59l-18.54-24.72H220.87l-18.54,24.72A26.31,26.31,0,0,1,181.15,512"/><path class="d" d="M159.08,414.9c5.29,0,8.82-3.53,8.82-8.83s-3.53-8.83-8.82-8.83H97.28V414.9Z"/><path class="d" d="M132.59,450.21c5.3,0,8.83-3.53,8.83-8.83s-3.53-8.83-8.83-8.83H97.28v17.66Z"/><path class="d" d="M238.53,397.24H203.22c-5.3,0-8.83,3.53-8.83,8.83s3.53,8.83,8.83,8.83h35.31V397.24Z"/><path class="d" d="M176.73,432.55c-5.29,0-8.83,3.53-8.83,8.83s3.54,8.83,8.83,8.83h61.8V432.55Z"/></svg>
                    </div>
                    <p class="subscriber-message-bottom">Most Recent Publish</p>
                    <p id="last-publish" class="subscriber-message-code">No Publishes</p>
                </div>
            </div>
        </div>
    </div>
</body>
<script src="https://cdn.pubnub.com/sdk/javascript/pubnub.4.21.7.min.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/gh/jaames/iro.js@dd7a818e71b583950920c625cafc41d1b6138b8d/dist/iro.min.js" type="text/javascript"></script>
<script type="text/javascript">
const colorDisplayElement = document.getElementById('lightbulb-fill');
const colorPickerElement = document.getElementById('color-picker');
const lastPublish = document.getElementById('last-publish');
const colorPickerChannel = 'color-picker-demo';
let currentDisplayColor = "";
colorDisplayElement.style = 'fill: #DDDDDD;';

const colorPicker = new iro.ColorPicker("#color-picker", { color: '#fff', padding: 6, borderWidth: 0, borderColor: '#fff', display: 'block', width: 250, height: 250, markerRadius: 4, anticlockwise: false,
});

// Connect to the PubNub network with your Pub/Sub keys
const pubnub = new PubNub({
    publishKey : 'pub-c-1deaccdb-dc4d-45c4-89cf-8a217bf85148',
    subscribeKey : 'sub-c-7e694b5a-4f10-11e9-913f-e6c25ba7076d'
});

// Publish a PubNub message on your color picker channel
const pnPublish = () => {
    const newColor = colorPicker.color.hexString.toUpperCase()
    if (currentDisplayColor === newColor) return;
    pubnub.publish({
        channel : colorPickerChannel,
        message: newColor
    });
};

colorPickerElement.addEventListener('click', pnPublish);

// Subscribe to color picker channel messages
pubnub.subscribe({
    channels: [colorPickerChannel]
});

// Callback function that executes when Publishes reach Subscribers
pubnub.addListener({
    message: function(event) {
        const incomingNewColor = event.message;
        if (incomingNewColor === currentDisplayColor) return;
        colorDisplayElement.style = `fill: ${event.message};`;
        colorPicker.color.hexString = incomingNewColor;
        currentDisplayColor = incomingNewColor;
        lastPublish.innerText = incomingNewColor;
    }
});
</script>
</html>